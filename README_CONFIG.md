# Private Key Configuration

The application supports two methods for loading private keys, with automatic fallback:

## 1. Environment Variables (Production Recommended)

Set the following environment variables with 64-character hexadecimal strings:

```bash
export CENTRAL_VAULT_PRIVATE_KEY="1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef"
export NETWORK_GOODS_VAULT_PRIVATE_KEY="fedcba0987654321fedcba0987654321fedcba0987654321fedcba0987654321"
```

### Production Deployment
```bash
# Set in your production environment
CENTRAL_VAULT_PRIVATE_KEY=your_actual_central_vault_key_here
NETWORK_GOODS_VAULT_PRIVATE_KEY=your_actual_network_goods_key_here
```

### Docker
```yaml
# docker-compose.yml
environment:
  - CENTRAL_VAULT_PRIVATE_KEY=${CENTRAL_VAULT_PRIVATE_KEY}
  - NETWORK_GOODS_VAULT_PRIVATE_KEY=${NETWORK_GOODS_VAULT_PRIVATE_KEY}
```

## 2. JSON Files (Local Development)

If environment variables are not set, the app automatically falls back to JSON files:

- `central_vault_keypair.json`
- `network_goods_vault_keypair.json`

### Generate Keys for Local Development
```bash
# Generate new keypair files
cargo run --bin generate_keys

# This creates the JSON files with proper format
```

## Configuration Priority

1. **Environment Variables** (checked first)
2. **JSON Files** (fallback if env vars not found)

## Key Format

- **Environment Variables**: 64-character hexadecimal strings (32 bytes)
- **JSON Files**: Delta SDK keypair format (generated by `generate_keys`)

## Security Best Practices

### Production
- ✅ Use environment variables
- ✅ Store keys in secure key management (AWS Secrets Manager, HashiCorp Vault, etc.)
- ✅ Rotate keys regularly
- ❌ Never commit keys to version control

### Development
- ✅ Use JSON files for local development
- ✅ Add `*.json` to `.gitignore` 
- ✅ Generate unique keys per developer
- ❌ Share private keys between developers

## Example Usage

### Local Development
```bash
# Generate keys
cargo run --bin generate_keys

# Run with JSON files
cargo run
```

### Production
```bash
# Set environment variables
export CENTRAL_VAULT_PRIVATE_KEY="your_key_here"
export NETWORK_GOODS_VAULT_PRIVATE_KEY="your_key_here"

# Run (will use env vars)
cargo run --release
```

## Troubleshooting

### "Failed to load keypair configuration"
- Check if environment variables are set correctly
- Verify JSON files exist and are readable
- Ensure hex strings are exactly 64 characters (32 bytes)

### "Invalid hex format"
- Remove any `0x` prefixes from hex strings
- Ensure only valid hex characters (0-9, a-f, A-F)
- Check for proper string length (64 characters)

### "Private key must be 32 bytes"
- Hex strings must be exactly 64 characters
- Each byte is represented by 2 hex characters